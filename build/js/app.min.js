$("#modal").animatedModal({modalTarget:"optionsModal",animatedIn:"lightSpeedIn",animatedOut:"bounceOutDown",color:"#40793e"});var iconShowing,animationEnd="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";$(document).ready(function(){loadSettings(),extensionManifest=chrome.runtime.getManifest(),$("#version").text("v"+extensionManifest.version),updateClock(),getGeolocation(),getQuote(),handleOptionsModal(),$("#digital_clock").bind("click",function(){clockToggle&&"digital"===clockType&&(clockFormat=12==clockFormat?24:12,updateClock())}),$("#refresh").bind("click",function(){getQuote()}),$(".flipper-container").bind("click",function(){$(".flipper-container").toggleClass("flip")}),$("#save_settings").bind("click",function(){weatherAppId=$("#weatherAppId").val(),saveSettings(),$(".close-optionsModal").click(),getWeather()}),$("#search_button").bind("click",search),$("#search_input").on("keydown",function(a){13!=a.which&&13!=a.keycode||search()}),setInterval(function(){$(".flipper-container").toggleClass("flip")},3e4),setInterval("updateClock()",1e3),setInterval("getQuote()",3e5),setInterval("getWeather()",9e4),navigator.onLine||setTimeout(displayWeather,2e3)});var search=function(){var a=$("#search_input").val();if($("#search_input").val(""),a)switch(searchEngine){case"Google":window.location.href="http://google.com/search?q="+a;break;case"Bing":window.location.href="http://bing.com/search?q="+a;break;case"Yahoo!":window.location.href="https://search.yahoo.com/search?p="+a}},loadSettings=function(){chrome.storage.sync.get({searchEnable:!0,searchEngine:"Google",quoteEnable:!0,optionsColor:"#40793e",navColor:"#6d4c2e",navLinks:["facebook"],clockEnable:!0,clockFormat:"12",clockToggle:!1,clockType:"digital",weatherEnable:!0,weatherUnits:"F",weatherTimestamp:0,weather:{},weatherAppId:null,geolocation:{}},function(a){console.log(a),$("#searchEnable").attr("checked",searchEnable=a.searchEnable),$("#searchEngine").val(searchEngine=a.searchEngine),$("#quoteEnable").attr("checked",quoteEnable=a.quoteEnable),$("#optionsColor").val(optionsColor=a.optionsColor),$("#navColor").val(navColor=a.navColor),$("#navLinks").val(navLinks=a.navLinks),$("#clockEnable").attr("checked",clockEnable=a.clockEnable),$("#clockFormat").val(clockFormat=a.clockFormat),$("#clockToggle").attr("checked",clockToggle=a.clockToggle),$("#clockType").val(clockType=a.clockType),$("#weatherEnable").attr("checked",weatherEnable=a.weatherEnable),$("#weatherUnits").val(weatherUnits=a.weatherUnits),$("#weatherAppId").val(weatherAppId=a.weatherAppId),weatherTimestamp=a.weatherTimestamp,geolocation=a.geolocation,weather=a.weather,updateUI()})},saveSettings=function(){chrome.storage.sync.set({searchEnable:searchEnable,searchEngine:searchEngine,quoteEnable:quoteEnable,optionsColor:optionsColor,navColor:navColor,navLinks:navLinks,clockEnable:clockEnable,clockFormat:clockFormat,clockToggle:clockToggle,clockType:clockType,weatherEnable:weatherEnable,weatherUnits:weatherUnits,weatherAppId:weatherAppId},function(){$.amaran({theme:"colorful",content:{bgcolor:"#27ae60",color:"#fff",message:"Settings saved successully"},position:"bottom right",outEffect:"slideBottom"})})},saveTimestamp=function(){chrome.storage.sync.set({weatherTimestamp:weatherTimestamp})},saveLocation=function(){chrome.storage.sync.set({geolocation:geolocation})},saveWeather=function(){chrome.storage.sync.set({weather:weather})},handleOptionsModal=function(){$("#searchEnable").bind("click",function(){searchEnable=$("#searchEnable").prop("checked"),updateUI()}),$("#searchEngine").bind("click",function(){searchEngine=$("#searchEngine").val(),updateUI()}),$("#quoteEnable").bind("click",function(){quoteEnable=$("#quoteEnable").prop("checked"),updateUI()}),$("#optionsColor").on("change",function(){optionsColor=$("#optionsColor").val(),updateUI()}),$("#navColor").on("change",function(){navColor=$("#navColor").val(),updateUI()}),$("#navLinks").on("change",function(){navLinks=$("#navLinks").val(),updateUI()}),$("#clockEnable").bind("click",function(){clockEnable=$("#clockEnable").prop("checked"),updateUI()}),$("#clockFormat").bind("click",function(){clockFormat=parseInt($("#clockFormat").val())}),$("#clockToggle").bind("click",function(){clockToggle=$("#clockToggle").is(":checked"),clockFormat=parseInt($("#clockFormat").val())}),$("#clockType").bind("click",function(){clockType=$("#clockType").val(),updateUI()}),$("#weatherEnable").bind("click",function(){weatherEnable=$("#weatherEnable").prop("checked"),updateUI()}),$("#weatherUnits").bind("click",function(){weatherUnits=$("#weatherUnits").val(),getGeolocation()})},updateUI=function(){searchEnable?($(".search-box").addClass("active"),$("#searchEngine").parents("div.option_element").addClass("active")):($(".search-box").removeClass("active"),$("#searchEngine").parents("div.option_element").removeClass("active")),$("#search_input").attr("placeholder","Search "+searchEngine+"..."),quoteEnable?$(".quote").addClass("active"):$(".quote").removeClass("active"),$("#optionsColor").parents("label.color").css("background",optionsColor),$("#optionsModal").css("background",optionsColor),$(".modalContainer").css("color",optionsColor),$(".modalContainer legend").css("color",optionsColor),$(".modalContainer option").css("color",optionsColor),$(".modalContainer select").css("color",optionsColor),$("#navColor").parents("label.color").css("background",navColor),$("nav").css("background",navColor),$("nav").empty(),navLinks.forEach(function(a){var b=$("<a>").attr("href",$("[value='"+a+"']").data("link")).appendTo($("nav"));$("<i>").addClass("fa fa-"+a.toLowerCase()+" fa-4x").appendTo(b)}),clockEnable?$("#clockType").parents("div.option_element").addClass("active"):($("#clockType").parents("div.option_element").removeClass("active"),$("#clockFormat").parents("div.option_element").removeClass("active"),$("#clockToggle").parents("div.option_element").removeClass("active"),$("#analog_clock").removeClass("active"),$("#digital_clock").removeClass("active")),clockEnable&&"digital"===clockType?($("#digital_clock").addClass("active"),$("#analog_clock").removeClass("active"),$("#clockFormat").parents("div.option_element").addClass("active"),$("#clockToggle").parents("div.option_element").addClass("active")):clockEnable&&"analog"===clockType&&($("#analog_clock").addClass("active"),$("#digital_clock").removeClass("active"),$("#clockFormat").parents("div.option_element").removeClass("active"),$("#clockToggle").parents("div.option_element").removeClass("active")),weatherEnable?($("#weather").addClass("active"),$("#weatherUnits").parents("div.option_element").addClass("active"),$("#weatherAppId").parents("div.option_element").addClass("active")):($("#weather").removeClass("active"),$("#weatherUnits").parents("div.option_element").removeClass("active"),$("#weatherAppId").parents("div.option_element").removeClass("active"))},getQuote=function(){$.ajax({method:"get",type:"json",url:"https://andruxnet-random-famous-quotes.p.mashape.com/?cat=famous",headers:{"X-Mashape-Key":"fdsv5ceSE2mshy4trzTyQNdsdh7rp1L6vaNjsnlfpuequ1zlJl"},success:function(a){var b=JSON.parse(a);setQuote(b.quote,b.author)},error:function(){setQuote("Well done is better than well said.","Benjamin Franklin")}})},getImages=function(a){var b=a.data.children,c=Math.floor(Math.random()*b.length);console.log("Post #: "+c);var d;d=void 0!=b[c].data.preview?b[c].data.preview.images[0].source.url:"default.jpg",document.body.style.backgroundImage="url('"+d+"')"},setQuote=function(a,b){$("#quote-text").text(a),""===b&&(b="Unknown"),$("#quote-author").text(b)},getGeolocation=function(){navigator.geolocation.getCurrentPosition(function(a){geolocation.coords={lat:a.coords.latitude,long:a.coords.longitude},saveLocation(),getCityName()})},getCityName=function(){navigator.onLine?$.ajax({url:"http://maps.googleapis.com/maps/api/geocode/json?latlng="+geolocation.coords.lat+","+geolocation.coords.long+"&sensor=true",success:function(a){$.each(a.results[0].address_components,function(a,b){b.types.includes("locality")?city=b.long_name:b.types.includes("administrative_area_level_1")&&(state=b.short_name)}),geolocation.place=city+", "+state,saveLocation()},complete:function(a,b){getWeather()}}):getWeather()},getWeather=function(){currentTimestamp=+new Date,currentTimestamp>weatherTimestamp+6e5||$.isEmptyObject(weather)?(weatherTimestamp=+new Date,saveTimestamp(),navigator.onLine?$.ajax({url:"http://api.openweathermap.org/data/2.5/weather?lat="+geolocation.coords.lat+"&lon="+geolocation.coords.long+"&appid="+weatherAppId,success:function(a){weatherEnable&&$("#weather").addClass("active"),console.log(a),weather={temp:a.main.temp,icon:a.weather[0].id,wind:{deg:a.wind.deg,speed:a.wind.speed},sunrise:a.sys.sunrise,sunset:a.sys.sunrise},saveWeather(),displayWeather()},error:function(a,b,c){"401"==a.status&&($.amaran({theme:"colorful",content:{bgcolor:"#f44b42",color:"#fff",message:"Unable to fetch weather.  Please provide API key in settings."},position:"bottom right",outEffect:"slideBottom"}),$("#weather").removeClass("active"))}}):displayWeather()):displayWeather()},displayWeather=function(){$("#location").text(geolocation.place);var a=+new Date;a/1e3>=weather.sunrise&&a/1e3<=weather.sunset?$("#icon").addClass("owf-"+weather.icon+"-d"):$("#icon").addClass("owf-"+weather.icon+"-n"),$("#icon").addClass("animated fadeIn"),"F"===weatherUnits?$("#temperature").text(Math.round(1.8*weather.temp-459.67)):$("#temperature").text(Math.round(weather.temp-273.15)),$("#wind").addClass("wi-wind").addClass("from-"+weather.wind.deg+"-deg");for(var b=data.query.results.channel.item.forecast,c=1;c<=3;c++)forecastItem(c,b[c]);iconShowing=!0,setInterval("toggleForecast()",5e3)},forecastItem=function(a,b){$("#"+a+" span").text(b.day),$("#"+a+" i").addClass("active wi-yahoo-"+b.code),"F"===weatherUnits?$("#"+a+" p").text(Math.round(b.high)):$("#"+a+" p").text(Math.round((b.high-32)*(5/9)))},toggleForecast=function(){iconShowing=!iconShowing;for(var a=[],b=0;b<3;b++)a.push($("#"+(b+1)));a.forEach(function(a){iconShowing?a.find("p").addClass("animated fadeOut").one(animationEnd,function(){a.find("p").removeClass("animated fadeOut").removeClass("active"),a.find("i").addClass("active").addClass("animated fadeIn").one(animationEnd,function(){a.find("i").removeClass("animated fadeIn")})}):a.find("i").addClass("animated fadeOut").one(animationEnd,function(){a.find("i").removeClass("animated fadeOut").removeClass("active"),a.find("p").addClass("active").addClass("animated fadeIn").one(animationEnd,function(){a.find("p").removeClass("animated fadeIn")})})})},updateClock=function(){var a=new Date,b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();sdeg=d/60*360,mdeg=c/60*360+d/60,hdeg=b/12*360+c/60*30,c=c<10?"0"+a.getMinutes():a.getMinutes(),12==clockFormat?(b=a.getHours()>12?a.getHours()-12:a.getHours(),0==a.getHours()&&(b=12)):b=a.getHours(),$("#digital_clock h1").text(b+":"+c),$(".second").css("transform","rotate("+sdeg+"deg)"),$(".minute").css("transform","rotate("+mdeg+"deg)"),$(".hour").css("transform","rotate("+hdeg+"deg)")};